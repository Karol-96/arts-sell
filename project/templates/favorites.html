{% extends 'layout.html' %}

{% block title %}My Favorites{% endblock %}

{% block main %}
<div class="favorites-container">
    <div class="container">
        <div class="favorites-header text-center mb-5">
            <h1 class="display-4 fw-bold mb-3">Favorite Artworks</h1>
            <p class="lead text-muted">
                {% if favorites %}
                    You have {{ favorites|length }} artwork{{ 's' if favorites|length != 1 else '' }} in your favorites
                {% else %}
                    No artworks in your favorites yet
                {% endif %}
            </p>
        </div>

        {% if favorites %}
        <div class="gallery-container">
            <div class="row justify-content-start g-4">
                {% for favorite in favorites %}
                <div class="col-12 col-md-6 col-lg-4">
                    <div class="artwork-card border-0 bg-transparent shadow-sm h-100 d-flex flex-column">
                        <div class="artwork-image-container position-relative">
                            <a href="{{ url_for('main.artwork_detail', artwork_id=favorite.id) }}" class="text-decoration-none text-dark">
                                <img src="{{ url_for('static', filename=favorite.image_url.lstrip('\\') if favorite.image_url else 'img/placeholder.png') }}" 
                                     class="card-img-top artwork-image" alt="{{ favorite.title }}">
                                <div class="artwork-overlay">
                                    <div class="overlay-content">
                                        <span class="view-details">View Details</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div class="card-body d-flex flex-column flex-grow-1 p-3">
                            <a href="{{ url_for('main.artwork_detail', artwork_id=favorite.id) }}" class="text-decoration-none text-dark">
                                <h5 class="card-title mb-2 text-start">{{ favorite.title }}</h5>
                                <p class="card-text mb-1 text-start">{{ favorite.artist_name | upper }}</p>
                                <p class="text-muted small mb-0 text-start">{{ favorite.medium | capitalize }} - {{ favorite.dimensions }}</p>
                            </a>
                            <div class="mt-2">
                                <small class="text-muted">Added to favorites: {{ favorite.favorited_at.strftime('%B %d, %Y') if favorite.favorited_at else 'Unknown' }}</small>
                            </div>
                        </div>
                        <div class="card-footer d-flex justify-content-between align-items-center p-3 mt-3">
                            <div class="pricing">
                                <p class="mb-0 fw-bold text-primary">{{ favorite.currency }}{{ "%.2f"|format(favorite.price) }}</p>
                                <small class="text-muted">/ Month</small>
                            </div>
                            <!-- Action buttons: add to cart & favorite -->
                            <div class="action d-flex gap-2 align-items-center">
                                <form method="POST" action="{{ url_for('main.remove_favorite', artwork_id=favorite.id) }}" style="display: inline;">
                                    <button type="submit" class="btn-favorite favorited" title="Remove from favorites">
                                        <i class="fa fa-heart"></i>
                                    </button>
                                </form>
                                {% if favorite.status == 'available' %}
                                    <form method="POST" action="{{ url_for('main.add_cart', artwork_id=favorite.id) }}" style="display: inline;">
                                        <button type="submit" class="btn-cart" title="Add to cart">
                                            <i class="fa fa-shopping-cart"></i>
                                        </button>
                                    </form>
                                {% else %}
                                    <button type="button" class="btn-cart disabled" title="Not available" disabled>
                                        <i class="fa fa-shopping-cart"></i>
                                    </button>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% else %}
        <!-- If not favorites -->
        <div class="row">
            <div class="col-12">
                <div class="no-favorites text-center py-5">
                    <h4 class="mt-3">No favorites yet</h4>
                    <p class="text-muted mb-4">
                        Start exploring our collection and add artworks to your favorites!
                    </p>
                    <a href="{{ url_for('main.artworks') }}" class="btn btn-action">Browse Artworks</a>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}